{
  "$schema": "lpp/v0.1",
  "id": "lpp_orchestrator",
  "name": "L++ Orchestrator",
  "version": "1.0.0",
  "description": "Orchestrates blueprint execution using the four atomic operations",
  "context_schema": {
    "properties": {
      "error": {
        "type": "string"
      },
      "result": {
        "type": "object"
      },
      "current_state": {
        "type": "string"
      },
      "event": {
        "type": "object"
      },
      "traces": {
        "type": "array"
      }
    }
  },
  "states": {
    "idle": {
      "name": "Idle",
      "description": "Waiting for event dispatch"
    },
    "finding_transition": {
      "name": "Finding Transition",
      "description": "Searching for matching transition"
    },
    "evaluating_gates": {
      "name": "Evaluating Gates",
      "description": "Checking gate conditions"
    },
    "executing_actions": {
      "name": "Executing Actions",
      "description": "Running transition actions"
    },
    "transitioning": {
      "name": "Transitioning",
      "description": "Performing state transition"
    },
    "complete": {
      "name": "Complete",
      "description": "Event processed successfully"
    },
    "error": {
      "name": "Error",
      "description": "Processing failed with error"
    }
  },
  "transitions": [
    {
      "id": "t_dispatch",
      "from": "idle",
      "to": "finding_transition",
      "on_event": "DISPATCH_EVENT"
    },
    {
      "id": "t_found",
      "from": "finding_transition",
      "to": "evaluating_gates",
      "on_event": "TRANSITION_FOUND"
    },
    {
      "id": "t_gates_pass",
      "from": "evaluating_gates",
      "to": "executing_actions",
      "on_event": "GATES_PASSED"
    },
    {
      "id": "t_actions_done",
      "from": "executing_actions",
      "to": "transitioning",
      "on_event": "ACTIONS_DONE"
    },
    {
      "id": "t_transition_done",
      "from": "transitioning",
      "to": "complete",
      "on_event": "TRANSITION_DONE"
    },
    {
      "id": "t_no_transition",
      "from": "finding_transition",
      "to": "error",
      "on_event": "NO_TRANSITION"
    },
    {
      "id": "t_gates_fail",
      "from": "evaluating_gates",
      "to": "error",
      "on_event": "GATES_FAILED"
    },
    {
      "id": "t_action_error",
      "from": "executing_actions",
      "to": "error",
      "on_event": "ACTION_ERROR"
    },
    {
      "id": "t_reset",
      "from": "*",
      "to": "idle",
      "on_event": "RESET"
    }
  ],
  "gates": {
    "g_has_transition": {
      "type": "expression",
      "expression": "transition is not None"
    },
    "g_not_terminal": {
      "type": "expression",
      "expression": "current_state not in terminal_states"
    }
  },
  "actions": {
    "a_find_transition": {
      "type": "compute",
      "compute_unit": "impl:_find_transition",
      "description": "Find matching transition for event"
    },
    "a_evaluate_gate": {
      "type": "compute",
      "compute_unit": "impl:atom_EVALUATE",
      "description": "Evaluate gate expression"
    },
    "a_mutate_context": {
      "type": "compute",
      "compute_unit": "impl:atom_MUTATE",
      "description": "Mutate context value"
    },
    "a_dispatch_compute": {
      "type": "compute",
      "compute_unit": "impl:atom_DISPATCH",
      "description": "Dispatch compute operation"
    },
    "a_transition": {
      "type": "compute",
      "compute_unit": "impl:atom_TRANSITION",
      "description": "Perform state transition"
    },
    "a_append_trace": {
      "type": "compute",
      "compute_unit": "impl:traces.append",
      "description": "Append transition trace"
    }
  },
  "entry_state": "idle",
  "terminal_states": [
    "complete",
    "error"
  ]
}
