{
  "$schema": "lpp/v0.1",
  "id": "lpp_schema",
  "name": "L++ Blueprint Schema",
  "version": "1.0.0",
  "description": "Schema types for blueprint structure including states, transitions, gates, and actions",
  "context_schema": {
    "properties": {
      "error": {
        "type": "string"
      },
      "result": {
        "type": "object"
      },
      "state_id": {
        "type": "string"
      },
      "transitions": {
        "type": "array"
      }
    }
  },
  "states": {
    "idle": {
      "name": "Idle",
      "description": "Schema ready for queries"
    },
    "querying": {
      "name": "Querying",
      "description": "Processing a schema query"
    },
    "complete": {
      "name": "Complete",
      "description": "Query completed successfully"
    },
    "error": {
      "name": "Error",
      "description": "Query failed with error"
    }
  },
  "transitions": [
    {
      "id": "t_query_state",
      "from": "idle",
      "to": "querying",
      "on_event": "GET_STATE"
    },
    {
      "id": "t_query_transitions",
      "from": "idle",
      "to": "querying",
      "on_event": "GET_TRANSITIONS"
    },
    {
      "id": "t_query_gate",
      "from": "idle",
      "to": "querying",
      "on_event": "GET_GATE"
    },
    {
      "id": "t_query_action",
      "from": "idle",
      "to": "querying",
      "on_event": "GET_ACTION"
    },
    {
      "id": "t_done",
      "from": "querying",
      "to": "complete",
      "on_event": "QUERY_DONE"
    },
    {
      "id": "t_err_not_found",
      "from": "querying",
      "to": "error",
      "on_event": "NOT_FOUND"
    },
    {
      "id": "t_reset",
      "from": "*",
      "to": "idle",
      "on_event": "RESET"
    }
  ],
  "gates": {
    "g_state_exists": {
      "type": "expression",
      "expression": "state_id in states"
    }
  },
  "actions": {
    "a_get_state": {
      "type": "compute",
      "compute_unit": "impl:states.get",
      "description": "Get state by ID"
    },
    "a_get_transitions": {
      "type": "compute",
      "compute_unit": "impl:get_transitions_from",
      "description": "Get transitions from a state"
    },
    "a_get_gate": {
      "type": "compute",
      "compute_unit": "impl:gates.get",
      "description": "Get gate by ID"
    },
    "a_get_action": {
      "type": "compute",
      "compute_unit": "impl:actions.get",
      "description": "Get action by ID"
    },
    "a_raise_key_error": {
      "type": "compute",
      "compute_unit": "impl:KeyError",
      "description": "Raise KeyError for missing item"
    }
  },
  "entry_state": "idle",
  "terminal_states": [
    "complete",
    "error"
  ]
}
