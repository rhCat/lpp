flowchart TD
    %% L++ Logic CAD Export
    state_idle(["<b>idle</b><br/>No blueprint loaded, waiting for input"]):::entry
    state_error(["<b>error</b><br/>Error state"])
    state_loaded(["<b>loaded</b><br/>Blueprint loaded, ready to debug"])
    state_debugging(["<b>debugging</b><br/>Actively debugging, can step through execution"])
    state_paused(["<b>paused</b><br/>Paused at a breakpoint"])
    gate_t_0_0{{"no_blueprint?"}}
    state_idle -- "LOAD" --> gate_t_0_0
    act_t_0_0[["load_blueprint"]]
    gate_t_0_0 -- True --> act_t_0_0
    act_t_0_0 --> state_loaded
    act_t_1_0[["set_error"]]
    state_idle -- "LOAD_FAILED" --> act_t_1_0
    act_t_1_0 --> state_error
    act_t_2_0[["load_blueprint"]]
    state_loaded -- "LOAD" --> act_t_2_0
    act_t_2_0 --> state_loaded
    act_t_3_0[["load_blueprint"]]
    state_debugging -- "LOAD" --> act_t_3_0
    act_t_3_0 --> state_loaded
    gate_t_4_0{{"has_blueprint?"}}
    state_loaded -- "START" --> gate_t_4_0
    act_t_4_0[["init_debug_session, render_status"]]
    gate_t_4_0 -- True --> act_t_4_0
    act_t_4_0 --> state_debugging
    act_t_5_0[["set_breakpoint"]]
    state_loaded -- "SET_BREAKPOINT" --> act_t_5_0
    act_t_5_0 --> state_loaded
    act_t_6_0[["set_breakpoint"]]
    state_debugging -- "SET_BREAKPOINT" --> act_t_6_0
    act_t_6_0 --> state_debugging
    act_t_7_0[["set_breakpoint"]]
    state_paused -- "SET_BREAKPOINT" --> act_t_7_0
    act_t_7_0 --> state_paused
    act_t_8_0[["remove_breakpoint"]]
    state_debugging -- "REMOVE_BREAKPOINT" --> act_t_8_0
    act_t_8_0 --> state_debugging
    act_t_9_0[["remove_breakpoint"]]
    state_paused -- "REMOVE_BREAKPOINT" --> act_t_9_0
    act_t_9_0 --> state_paused
    act_t_10_0[["list_breakpoints"]]
    state_debugging -- "LIST_BREAKPOINTS" --> act_t_10_0
    act_t_10_0 --> state_debugging
    act_t_11_0[["list_breakpoints"]]
    state_paused -- "LIST_BREAKPOINTS" --> act_t_11_0
    act_t_11_0 --> state_paused
    gate_t_12_0{{"is_not_paused?"}}
    state_debugging -- "STEP" --> gate_t_12_0
    act_t_12_0[["step"]]
    gate_t_12_0 -- True --> act_t_12_0
    act_t_12_0 --> state_debugging
    state_debugging -- "STEP_HIT_BP" --> state_paused
    gate_t_14_0{{"is_not_paused?"}}
    state_debugging -- "STEP_OVER" --> gate_t_14_0
    act_t_14_0[["step_over"]]
    gate_t_14_0 -- True --> act_t_14_0
    act_t_14_0 --> state_debugging
    gate_t_15_0{{"can_step_back?"}}
    state_debugging -- "STEP_BACK" --> gate_t_15_0
    act_t_15_0[["step_back"]]
    gate_t_15_0 -- True --> act_t_15_0
    act_t_15_0 --> state_debugging
    gate_t_16_0{{"can_step_back?"}}
    state_paused -- "STEP_BACK" --> gate_t_16_0
    act_t_16_0[["step_back, clear_hit_breakpoint"]]
    gate_t_16_0 -- True --> act_t_16_0
    act_t_16_0 --> state_debugging
    act_t_17_0[["run_to_breakpoint"]]
    state_debugging -- "RUN" --> act_t_17_0
    act_t_17_0 --> state_debugging
    state_debugging -- "RUN_HIT_BP" --> state_paused
    act_t_19_0[["clear_hit_breakpoint, resume_execution"]]
    state_paused -- "CONTINUE" --> act_t_19_0
    act_t_19_0 --> state_debugging
    act_t_20_0[["clear_hit_breakpoint, continue_execution"]]
    state_paused -- "RUN" --> act_t_20_0
    act_t_20_0 --> state_debugging
    act_t_21_0[["pause_execution"]]
    state_debugging -- "PAUSE" --> act_t_21_0
    act_t_21_0 --> state_paused
    state_debugging -- "STOP" --> state_loaded
    act_t_23_0[["clear_hit_breakpoint"]]
    state_paused -- "STOP" --> act_t_23_0
    act_t_23_0 --> state_loaded
    act_t_24_0[["inspect_state"]]
    state_debugging -- "INSPECT_STATE" --> act_t_24_0
    act_t_24_0 --> state_debugging
    act_t_25_0[["inspect_state"]]
    state_paused -- "INSPECT_STATE" --> act_t_25_0
    act_t_25_0 --> state_paused
    act_t_26_0[["inspect_context"]]
    state_debugging -- "INSPECT_CONTEXT" --> act_t_26_0
    act_t_26_0 --> state_debugging
    act_t_27_0[["inspect_context"]]
    state_paused -- "INSPECT_CONTEXT" --> act_t_27_0
    act_t_27_0 --> state_paused
    act_t_28_0[["evaluate_expression"]]
    state_debugging -- "EVAL" --> act_t_28_0
    act_t_28_0 --> state_debugging
    act_t_29_0[["evaluate_expression"]]
    state_paused -- "EVAL" --> act_t_29_0
    act_t_29_0 --> state_paused
    act_t_30_0[["add_watch"]]
    state_debugging -- "ADD_WATCH" --> act_t_30_0
    act_t_30_0 --> state_debugging
    act_t_31_0[["add_watch"]]
    state_paused -- "ADD_WATCH" --> act_t_31_0
    act_t_31_0 --> state_paused
    act_t_32_0[["remove_watch"]]
    state_debugging -- "REMOVE_WATCH" --> act_t_32_0
    act_t_32_0 --> state_debugging
    act_t_33_0[["get_watches"]]
    state_debugging -- "GET_WATCHES" --> act_t_33_0
    act_t_33_0 --> state_debugging
    act_t_34_0[["get_watches"]]
    state_paused -- "GET_WATCHES" --> act_t_34_0
    act_t_34_0 --> state_paused
    act_t_35_0[["get_history"]]
    state_debugging -- "HISTORY" --> act_t_35_0
    act_t_35_0 --> state_debugging
    act_t_36_0[["get_history"]]
    state_paused -- "HISTORY" --> act_t_36_0
    act_t_36_0 --> state_paused
    gate_t_37_0{{"has_history?"}}
    state_debugging -- "GOTO" --> gate_t_37_0
    act_t_37_0[["goto_step"]]
    gate_t_37_0 -- True --> act_t_37_0
    act_t_37_0 --> state_debugging
    gate_t_38_0{{"has_history?"}}
    state_paused -- "GOTO" --> gate_t_38_0
    act_t_38_0[["goto_step, clear_hit_breakpoint"]]
    gate_t_38_0 -- True --> act_t_38_0
    act_t_38_0 --> state_debugging
    act_t_39_0[["compare_states"]]
    state_debugging -- "COMPARE" --> act_t_39_0
    act_t_39_0 --> state_debugging
    act_t_40_0[["compare_states"]]
    state_paused -- "COMPARE" --> act_t_40_0
    act_t_40_0 --> state_paused
    act_t_41_0[["reset_session"]]
    state_debugging -- "RESET" --> act_t_41_0
    act_t_41_0 --> state_debugging
    act_t_42_0[["reset_session, clear_hit_breakpoint"]]
    state_paused -- "RESET" --> act_t_42_0
    act_t_42_0 --> state_debugging
    act_t_43_0[["render_status"]]
    state_debugging -- "STATUS" --> act_t_43_0
    act_t_43_0 --> state_debugging
    act_t_44_0[["render_status"]]
    state_paused -- "STATUS" --> act_t_44_0
    act_t_44_0 --> state_paused
    act_t_45_0[["unload_blueprint"]]
    state_loaded -- "UNLOAD" --> act_t_45_0
    act_t_45_0 --> state_idle
    act_t_46_0[["unload_blueprint"]]
    state_debugging -- "UNLOAD" --> act_t_46_0
    act_t_46_0 --> state_idle
    act_t_47_0[["unload_blueprint, clear_hit_breakpoint"]]
    state_paused -- "UNLOAD" --> act_t_47_0
    act_t_47_0 --> state_idle
    act_t_48_0[["clear_error"]]
    state_error -- "CLEAR" --> act_t_48_0
    act_t_48_0 --> state_idle
    classDef entry fill:#e1f5fe,stroke:#01579b,stroke-width:4px
    classDef terminal fill:#eceff1,stroke:#263238,stroke-width:4px